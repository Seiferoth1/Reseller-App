<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Reseller Pro</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { primary: '#4F52C9', secondary: '#EEEAF8', accent: '#DDE3F9', pink: '#E040A0', dark: '#1B1D3A' }
                    },
                    borderRadius: { '4xl': '2rem' }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #EEEAF8; color: #1B1D3A; margin: 0; overflow-x: hidden; }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid white; box-shadow: 0 10px 30px rgba(79, 82, 201, 0.05); }
        .bouncy { transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); cursor: pointer; }
        .bouncy:active { transform: scale(0.95); }
        .nav-pill { background: #1B1D3A; box-shadow: 0 10px 25px rgba(27, 29, 58, 0.3); }
        
        /* Smooth Scroll for Mobile */
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="pb-32">

    <header class="p-6 flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-extrabold bg-gradient-to-r from-brand-primary to-brand-pink bg-clip-text text-transparent italic">Reseller Pro</h1>
            <div class="flex items-center gap-2 mt-1">
                <span id="conn-indicator" class="w-2 h-2 bg-yellow-400 rounded-full animate-pulse"></span>
                <p id="status-tag" class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Waiting for Key...</p>
            </div>
        </div>
        <div class="w-10 h-10 glass-card rounded-full flex items-center justify-center bouncy">
            <i data-lucide="user" class="w-5 h-5 text-brand-primary"></i>
        </div>
    </header>

    <main class="px-4 space-y-6">
        <div class="grid grid-cols-2 gap-4">
            <div class="glass-card p-6 rounded-4xl relative overflow-hidden">
                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-tighter">Gross Revenue</p>
                <h2 id="revenue-val" class="text-2xl font-black mt-1">$0</h2>
                <div class="absolute -right-2 -bottom-2 opacity-5 text-brand-primary"><i data-lucide="dollar-sign" class="w-16 h-16"></i></div>
            </div>
            <div class="bg-brand-primary p-6 rounded-4xl shadow-lg shadow-brand-primary/20">
                <p class="text-[10px] font-bold text-white/60 uppercase tracking-tighter">Net Profit</p>
                <h2 id="profit-val" class="text-2xl font-black mt-1 text-white">$0</h2>
            </div>
        </div>

        <div class="glass-card rounded-4xl p-2 min-h-[400px]">
            <div class="p-4 flex justify-between items-center border-b border-gray-100/50 mb-2">
                <h3 class="font-bold text-brand-dark flex items-center gap-2">
                    <i data-lucide="package" class="w-4 h-4 text-brand-pink"></i> Inventory
                </h3>
                <button class="p-2 bg-brand-accent/30 rounded-full text-brand-primary bouncy">
                    <i data-lucide="search" class="w-4 h-4"></i>
                </button>
            </div>
            
            <div id="main-list" class="space-y-3 p-2">
                <div class="p-12 text-center">
                    <div class="inline-block animate-spin mb-4"><i data-lucide="refresh-cw" class="text-brand-accent"></i></div>
                    <p class="text-xs text-gray-400 font-medium">Please enter your Supabase Key in the code to sync your data.</p>
                </div>
            </div>
        </div>
    </main>

    <nav class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[92%] max-w-md h-20 nav-pill rounded-full flex items-center justify-around px-2 z-50">
        <button class="p-4 text-white bouncy"><i data-lucide="layout-dashboard"></i></button>
        <button class="p-4 text-white/40 bouncy"><i data-lucide="trending-up"></i></button>
        
        <button onclick="openQuickAdd()" class="w-16 h-16 bg-brand-pink rounded-full -translate-y-5 border-[6px] border-[#EEEAF8] flex items-center justify-center text-white shadow-xl shadow-brand-pink/30 bouncy">
            <i data-lucide="plus" class="w-8 h-8"></i>
        </button>
        
        <button class="p-4 text-white/40 bouncy"><i data-lucide="milestone"></i></button>
        <button class="p-4 text-white/40 bouncy"><i data-lucide="settings"></i></button>
    </nav>

    <script>
        // --- 1. YOUR CONNECTION SETTINGS ---
        const SB_URL = 'https://itfnotvmdulwubqndnyr.supabase.co';
        
        // PASTE YOUR FULL ANON KEY INSIDE THESE QUOTES:
        const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBnbGJyb3FyemNoYWxmaXZoeGp1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEyNzczNjksImV4cCI6MjA4Njg1MzM2OX0.txVH7ywpKEC1bGnufqF36bwqWLIiTdmNmx9ZYYN2n_Q'; 

        // --- 2. THE LOGIC ---
        async function initApp() {
            lucide.createIcons();
            const listElement = document.getElementById('main-list');
            const statusTag = document.getElementById('status-tag');
            const indicator = document.getElementById('conn-indicator');

            if (SB_KEY === 'PASTE_YOUR_KEY_HERE' || SB_KEY.length < 50) {
                console.error("Missing valid Supabase Key.");
                return;
            }

            try {
                const client = supabase.createClient(SB_URL, SB_KEY);
                const { data, error } = await client.from('inventory').select('*').order('created_at', { ascending: false });

                if (error) throw error;

                // Success State
                statusTag.innerText = "Sync Active";
                indicator.classList.remove('bg-yellow-400', 'animate-pulse');
                indicator.classList.add('bg-green-500');
                
                renderInventory(data);
            } catch (err) {
                console.error("Connection error:", err);
                statusTag.innerText = "Connection Failed";
                indicator.classList.add('bg-red-500');
            }
        }

        function renderInventory(items) {
            const container = document.getElementById('main-list');
            if (!items || items.length === 0) {
                container.innerHTML = `<div class="p-10 text-center text-gray-400 italic">No items in stock. Tap + to begin.</div>`;
                return;
            }

            let totalRev = 0; 
            let totalProf = 0;

            container.innerHTML = items.map(item => {
                const sale = Number(item.sale_price) || 0;
                const cost = Number(item.cost_price) || 0;
                const profit = sale - cost;
                
                totalRev += sale;
                totalProf += profit;

                return `
                    <div class="flex items-center gap-4 p-4 bg-white rounded-3xl border border-gray-50 bouncy group">
                        <div class="w-12 h-12 bg-brand-accent/50 rounded-2xl flex items-center justify-center font-extrabold text-brand-primary shadow-inner">
                            ${item.name[0].toUpperCase()}
                        </div>
                        <div class="flex-1">
                            <h4 class="font-bold text-sm text-brand-dark">${item.name}</h4>
                            <p class="text-[10px] text-gray-400 uppercase font-black tracking-widest">${item.category || 'RESELL'}</p>
                        </div>
                        <div class="text-right">
                            <div class="font-black text-brand-primary text-md">$${sale}</div>
                            <div class="text-[9px] font-bold text-green-500 bg-green-50 px-2 py-0.5 rounded-full inline-block">+$${profit}</div>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('revenue-val').innerText = `$${totalRev.toLocaleString()}`;
            document.getElementById('profit-val').innerText = `$${totalProf.toLocaleString()}`;
        }

        function openQuickAdd() {
            // This is where we'll build the bouncy "Add Item" popup next
            alert("Ready to build the 'Add Item' popup?");
        }

        window.onload = initApp;
    </script>
</body>
</html>